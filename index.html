<!DOCTYPE html>
<html>
<head>
   <meta charset="utf-8">
   <meta name="viewport" content="width=device-width">
   <script type="text/javascript" src="install.js"></script>
   <link rel="stylesheet" href="style.css" type="text/css" media="screen" title="no title" charset="utf-8">
   <title>Skip The Rope</title>
</head>
<body>
    <header class="bar">
        <!-- <a href="javascript:history.back();">&lt;</a> -->
        Skip the Rope
        <button id="btnInstall" hidden>install</button>
    </header>
    <!-- <nav class="bar">
        <a href="#home">go to home</a> or 
        <a href="#page">go to page</a>
    </nav> -->
    <section id="home">
        <div id="control" class="">Start skipping!</div>
		<div id="skips">0</div>

        <iframe id="facebook" src="https://www.facebook.com/plugins/like.php?href=http://alicelieutier.github.com/skiptherope/"
        scrolling="no" frameborder="0"
        style="border:none; width:450px; height:80px"></iframe>

    </section>
    <script type="text/javascript">
        var threshold = 8;
        var above = false;
        var nb_of_skips = 0;
        var started = false;

        function start(event) {
            nb_of_skips = 0;
            above = false;
            document.getElementById('skips').textContent = 0;
            window.addEventListener("devicemotion", count);
        }

        function stop(event) {
            window.removeEventListener("devicemotion", count);
        }

        function control(event) {
            if (!started) {
                start();
                this.textContent = "STOP";
                this.classList.add('stop');
            } else {
                stop();
                this.textContent = "Start skipping!";
                this.classList.remove('stop');
            } 
            started = !started; 
        }

        function count(event) {
            if (event.acceleration.y > 8) {
                above = true;
                return;
            }
            // if we are here, then we are underneath the threshold
            if (above) {
                nb_of_skips += 1;
                above = false;
                document.getElementById('skips').textContent = nb_of_skips;
            }
            return; 
        }
        document.addEventListener("DOMContentLoaded", function () {
           document.getElementById('control').addEventListener('click', control);
        });

    </script>
</body>
</html>
